# Система детекции усталости 


---

## Обзор системы
Интеллектуальная система определения усталости, использующая методы компьютерного зрения и двухуровневый классификатор на базе машин опорных векторов (**SVM**). Система анализирует геометрические параметры лица в реальном времени, обеспечивая высокую точность детекции

##  Алгоритм работы
Проект реализует двухуровневую архитектуру (**Stacking**) для фильтрации шума и минимизации ложных срабатываний:

* **Level 1 (Окна):** Сегментация видеопотока на временные окна по 180 кадров ($\approx 6$ сек). Вычисляются микро-состояния: частота моргания, длительность закрытия глаз и наличие зевков
* **Level 2 (Видео):** Глобальный анализ вектора предсказаний первого уровня. Модель оценивает динамику состояния на протяжении всего видеоряда


---

## Математический аппарат
Для оценки физиологического состояния используются биометрические метрики открытости глаз и рта

### Eye Aspect Ratio (EAR)
Характеризует степень открытости глаз:
$$EAR = \frac{\|p_2 - p_6\| + \|p_3 - p_5\|}{2 \|p_1 - p_4\|}$$


### Mouth Aspect Ratio (MAR)
Используется для детекции зевков:
$$MAR = \frac{\|p_{upper} - p_{lower}\|}{\|p_{left} - p_{right}\|}$$

---

##  Структура проекта
* `scanner.py`: Извлечение признаков из видеоархива и сохранение в JSON
* `main.py`: Обучение моделей SVC
* `check.py`: Тестирование модели на новых данных
* `webcamera.py`: Демонстрация работы на вебкамере

## Результаты
В ходе тестирования была достигнута точность:
**Accuracy = 83.33%**

---
## Запуск

### 1. Подготовка окружения

```bash
python -m venv Face-detection
.\Face-detection\Scripts\activate
```

### 2. Установка зависимостей

```bash
python.exe -m pip install --upgrade pip
pip install opencv-python numpy mediapipe scipy scikit-learn  
```

### 3. Скачивание репозитория
```bash
git clone https://github.com/Bibabibka/Face_Detection.git
cd Face_Detection
```

### 4. Запуск программы
```bash
python3 webcamera.py
```
Далее после того как вы закончили съемку нажмите на 'q' для получения результата вашего состояния
(Раскладка должна быть на английском)